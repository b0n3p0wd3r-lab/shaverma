# üí∞ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è Shaurmafia

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

‚úÖ **–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ Telegram Bot API**  
‚úÖ **6 –ø–∞–∫–µ—Ç–æ–≤ –º–æ–Ω–µ—Ç** —Å —Ä–∞–∑–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏  
‚úÖ **–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–º** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
‚úÖ **Web API** –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∏–≥—Ä–æ–π  
‚úÖ **JavaScript –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** –¥–ª—è Unity WebGL  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** –ø–ª–∞—Ç–µ–∂–µ–π  

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É backend
cd backend

# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª .env
cp env_example.txt .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª:
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_botfather
WEBAPP_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com
PAYMENT_PROVIDER_TOKEN=—Ç–æ–∫–µ–Ω_–æ—Ç_–ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ_–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ `PAYMENT_SETUP.md`:
- –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –≤ –ÆKassa
- –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ @BotFather
- –î–æ–±–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env`

### 3. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ (–≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
python bot.py

# –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
python web_api.py
```

## üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Unity

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ `UNITY_INTEGRATION.md` –¥–ª—è:
- –°–æ–∑–¥–∞–Ω–∏—è C# —Å–∫—Ä–∏–ø—Ç–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ JavaScript –ø–ª–∞–≥–∏–Ω–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å UI –∏–≥—Ä—ã

## üì± –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç–∞ ‚Üí `/start`
2. –ù–∞–∂–∏–º–∞–µ—Ç "üí∞ –ö—É–ø–∏—Ç—å –º–æ–Ω–µ—Ç—ã"
3. –í—ã–±–∏—Ä–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ 6 –ø–∞–∫–µ—Ç–æ–≤
4. –û–ø–ª–∞—á–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram Payments
5. –ú–æ–Ω–µ—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è
6. –í –∏–≥—Ä–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –±–∞–ª–∞–Ω—Å

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
1. **Bot** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ Telegram API
2. **UserDataManager** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å –≤ JSON —Ñ–∞–π–ª
3. **Web API** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä–µ
4. **Unity** –ø–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ JavaScript
5. **JavaScript Bridge** —Å–≤—è–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

## üíé –ü–∞–∫–µ—Ç—ã –º–æ–Ω–µ—Ç

| –ü–∞–∫–µ—Ç | –ú–æ–Ω–µ—Ç—ã | –¶–µ–Ω–∞ | –í—ã–≥–æ–¥–∞ |
|-------|--------|------|--------|
| –°—Ç–∞—Ä—Ç–æ–≤—ã–π | 100 | 50‚ÇΩ | 2 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |
| –ë–∞–∑–æ–≤—ã–π | 250 | 100‚ÇΩ | 2.5 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |
| –ü–æ–ø—É–ª—è—Ä–Ω—ã–π | 650 | 250‚ÇΩ | 2.6 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |
| –í—ã–≥–æ–¥–Ω—ã–π | 1400 | 500‚ÇΩ | 2.8 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |
| –ü—Ä–µ–º–∏—É–º | 3000 | 1000‚ÇΩ | 3 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |
| VIP | 6500 | 2000‚ÇΩ | 3.25 –º–æ–Ω–µ—Ç—ã/‚ÇΩ |

## üîß API Endpoints

### GET /api/user/balance
–ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
GET /api/user/balance?user_id=123&auth_date=1234567890
```

### GET /api/user/spend
–ü–æ—Ç—Ä–∞—Ç–∏—Ç—å –º–æ–Ω–µ—Ç—ã
```
GET /api/user/spend?user_id=123&amount=10&auth_date=1234567890
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Å–ø–∏—Å–∞–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è API

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ –ø–ª–∞—Ç–µ–∂–µ–π
–í—Å–µ —É—Å–ø–µ—à–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å:
```
Payment successful: user_id=123, amount=100, transaction_id=abc123
```

### –§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö
–ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `user_data.json`:
```json
{
  "123": {
    "coins": 100,
    "purchases": [
      {
        "amount": 100,
        "transaction_id": "abc123",
        "timestamp": 1234567890
      }
    ]
  }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –ÆKassa: `5555 5555 5555 4477`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–∫—É–ø–∫–∏

### 2. –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
```
/start - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/balance - –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å
üí∞ –ö—É–ø–∏—Ç—å –º–æ–Ω–µ—Ç—ã - –û—Ç–∫—Ä—ã—Ç—å –º–∞–≥–∞–∑–∏–Ω
```

### 3. API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
curl "http://localhost:8080/api/user/balance?user_id=123&auth_date=1234567890"

# –¢—Ä–∞—Ç–∞ –º–æ–Ω–µ—Ç
curl "http://localhost:8080/api/user/spend?user_id=123&amount=10&auth_date=1234567890"
```

## ‚ùó –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### CloudTips –ù–ï –ø–æ–¥—Ö–æ–¥–∏—Ç
- –ü—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–Ω–∞—Ç–æ–≤
- –ó–∞–ø—Ä–µ—â–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ÆKassa –∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–∞—Ä—Ç–∞—Ö
- –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –∫–æ–¥–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø—ã `user_data.json`
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **"Payment provider token is invalid"** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env
2. **"API not available"** ‚Üí –ó–∞–ø—É—Å—Ç–∏—Ç–µ web_api.py
3. **"Insufficient coins"** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. **CORS –æ—à–∏–±–∫–∏** ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

### –ö–æ–Ω—Ç–∞–∫—Ç—ã:
- Telegram Bot API: https://core.telegram.org/bots/payments
- –ÆKassa –ø–æ–¥–¥–µ—Ä–∂–∫–∞: support@yookassa.ru

---

üéâ **–ì–æ—Ç–æ–≤–æ!** –í–∞—à–∞ –∏–≥—Ä–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–∫—É–ø–∫—É –≤–Ω—É—Ç—Ä–∏–∏–≥—Ä–æ–≤–æ–π –≤–∞–ª—é—Ç—ã —á–µ—Ä–µ–∑ Telegram!
