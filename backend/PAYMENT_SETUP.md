# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –¥–ª—è Telegram Bot

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### 1. –í—ã–±–æ—Ä –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

–î–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è **–ÆKassa (–Ø–Ω–¥–µ–∫—Å.–ö–∞—Å—Å–∞)**:
- ‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Telegram
- ‚úÖ –ù–∏–∑–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Ä—Ç, –°–ë–ü, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤

### 2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –ÆKassa

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [yookassa.ru](https://yookassa.ru)
2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ –≤–∞—à–µ–º –±–∏–∑–Ω–µ—Å–µ
4. –î–æ–∂–¥–∏—Ç–µ—Å—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ 1-3 –¥–Ω—è)

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/mybots`
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
4. –ù–∞–∂–º–∏—Ç–µ **"Payments"**
5. –í—ã–±–µ—Ä–∏—Ç–µ **"YooKassa"**
6. –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –ÆKassa:
   - **Shop ID** (–∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ÆKassa)
   - **Secret Key** (–∏–∑ –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ÆKassa)
7. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π **Provider Token**

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `backend/`:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
WEBAPP_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.com
PAYMENT_PROVIDER_TOKEN=–ø–æ–ª—É—á–µ–Ω–Ω—ã–π_—Ç–æ–∫–µ–Ω_–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
```

### 5. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

#### –°–±–µ—Ä–±–∞–Ω–∫
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–æ–≥–æ —Ä—ã–Ω–∫–∞
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ –ÆKassa
- –í @BotFather –≤—ã–±–µ—Ä–∏—Ç–µ "Sberbank"

#### Stripe (–¥–ª—è –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∫–∞—Ä—Ç
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- –¢—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å–∞

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–æ–≤—ã–µ –ø–ª–∞—Ç–µ–∂–∏
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
2. –ÆKassa —Ç–µ—Å—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞: `5555 5555 5555 4477`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:
   - ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂
   - ‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–π –ø–ª–∞—Ç–µ–∂
   - ‚è±Ô∏è –¢–∞–π–º–∞—É—Ç –ø–ª–∞—Ç–µ–∂–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–æ—Ç–µ
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞: `python bot.py`
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
3. –ù–∞–∂–º–∏—Ç–µ "üí∞ –ö—É–ø–∏—Ç—å –º–æ–Ω–µ—Ç—ã"
4. –í—ã–±–µ—Ä–∏—Ç–µ –ª—é–±–æ–π –ø–∞–∫–µ—Ç
5. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚ùå **–ù–ò–ö–û–ì–î–ê** –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –∫–æ–¥–µ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–µ–π –≤ `process_pre_checkout`

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π:
```python
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# –í —Ñ—É–Ω–∫—Ü–∏–∏ process_successful_payment:
logger.info(f"Payment successful: user_id={user_id}, amount={coins_amount}, transaction_id={payment.telegram_payment_charge_id}")
```

## üÜò –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "Payment provider token is invalid"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω –≤ @BotFather

### "Currency not supported"
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –î–ª—è –†–æ—Å—Å–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ "RUB"

### –ü–ª–∞—Ç–µ–∂–∏ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å—É–º–º—ã (–≤ –∫–æ–ø–µ–π–∫–∞—Ö)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –ÆKassa: [support@yookassa.ru](mailto:support@yookassa.ru)
- Telegram Bot API: [core.telegram.org/bots/payments](https://core.telegram.org/bots/payments)
